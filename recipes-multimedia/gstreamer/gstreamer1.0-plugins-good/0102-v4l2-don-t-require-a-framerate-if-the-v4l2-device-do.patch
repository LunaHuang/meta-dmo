From: Michael Olbrich <m.olbrich@pengutronix.de>
Date: Tue, 21 May 2013 15:59:45 +0200
Subject: [PATCH] v4l2: don't require a framerate if the v4l2 device does not
 support setting it

Signed-off-by: Michael Olbrich <m.olbrich@pengutronix.de>
---
 sys/v4l2/gstv4l2object.c | 10 +---------
 1 file changed, 1 insertion(+), 9 deletions(-)

diff --git a/sys/v4l2/gstv4l2object.c b/sys/v4l2/gstv4l2object.c
index dbd1676..5d20f52 100644
--- a/sys/v4l2/gstv4l2object.c
+++ b/sys/v4l2/gstv4l2object.c
@@ -1488,8 +1488,7 @@ gst_v4l2_object_get_all_caps (void)
         if (gst_v4l2_formats[i].dimensions) {
           gst_structure_set (structure,
               "width", GST_TYPE_INT_RANGE, 1, GST_V4L2_MAX_SIZE,
-              "height", GST_TYPE_INT_RANGE, 1, GST_V4L2_MAX_SIZE,
-              "framerate", GST_TYPE_FRACTION_RANGE, 0, 1, 100, 1, NULL);
+              "height", GST_TYPE_INT_RANGE, 1, GST_V4L2_MAX_SIZE, NULL);
         }
         gst_caps_append_structure (caps, structure);
       }
@@ -1893,9 +1892,6 @@ return_data:
      * value */
     gst_structure_set_value (s, "framerate", &rates);
     g_value_unset (&rates);
-  } else {
-    gst_structure_set (s, "framerate", GST_TYPE_FRACTION_RANGE, 0, 1, 100, 1,
-        NULL);
   }
   return s;
 
@@ -2130,10 +2126,6 @@ default_frame_sizes:
     if (fix_num) {
       gst_structure_set (tmp, "framerate", GST_TYPE_FRACTION, fix_num,
           fix_denom, NULL);
-    } else {
-      /* if norm can't be used, copy the template framerate */
-      gst_structure_set (tmp, "framerate", GST_TYPE_FRACTION_RANGE, 0, 1,
-          100, 1, NULL);
     }
 
     if (min_w == max_w)
